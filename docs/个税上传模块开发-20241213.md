# 个税上传模块开发文档

## 开发时间
2024年12月13日

## 需求描述
在管理后台的前端代码中，仿照税费上传的页面，新增个税上传模块。

## 实现内容

### 1. 创建个税上传服务接口
**文件**: `src/services/personalTaxService.ts`

**功能**:
- 定义个税上传记录数据结构 `PersonalTaxUploadRecord`
- 定义上传响应数据结构 `PersonalTaxUploadResponse`
- 实现个税文件上传接口 `uploadPersonalTaxFile`
- 实现上传记录查询接口 `getUploadRecords`

**接口说明**:
- `POST /api/personal-tax/upload` - 上传个税文件
- `GET /api/personal-tax/records` - 获取上传记录列表，支持分页和期间筛选

### 2. 创建个税上传页面组件
**文件**: `src/components/PersonalTaxUploadView.tsx`

**功能特性**:
- 文件拖拽上传支持（Excel、CSV、PDF格式）
- Excel模板下载功能
- 上传记录列表展示
- 分页功能
- 期间筛选
- 文件大小限制（10MB）
- 上传进度显示
- 响应式设计

**UI组件**:
- 使用 `UserCheck` 图标作为页面标识
- 拖拽上传区域，支持文件选择和拖拽
- 数据表格展示上传记录
- 分页控件
- 期间选择器

### 3. 路由配置
**文件**: `src/App.tsx`

**修改内容**:
- 导入 `PersonalTaxUploadView` 组件
- 添加路由映射 `"personal-tax-upload": "/personal-tax-upload"`
- 添加路由配置 `<Route path="/personal-tax-upload" element={<PersonalTaxUploadView />} />`

### 4. 导航菜单配置
**文件**: `src/components/Sidebar.tsx`

**修改内容**:
- 在客服用户菜单中添加"个税上传"菜单项
- 使用 `Upload` 图标
- 配置菜单ID为 `"personal-tax-upload"`

## 技术实现

### 数据结构
```typescript
interface PersonalTaxUploadRecord {
  companyNo: string;        // 统一社会信用代码
  companyName: string;      // 公司名称
  taxName: string;          // 税种名称
  period: string;           // 所属期
  amount: number;           // 金额
}
```

### Excel模板格式
| 所属期 | 统一社会信用代码 | 客户名称 | 税种 | 金额 |
|--------|------------------|----------|------|------|
| 2025-09 | 91110000000000000X | 测试的公司的的0902 | 个人所得税 | 1000.00 |

### 文件上传限制
- 支持格式：Excel (.xlsx, .xls)、CSV (.csv)、PDF (.pdf)
- 文件大小：最大 10MB
- 上传方式：拖拽或点击选择

## 功能特点

1. **用户体验优化**
   - 拖拽上传支持
   - 实时上传进度显示
   - 友好的错误提示
   - 响应式设计适配不同屏幕

2. **数据管理**
   - 分页展示上传记录
   - 按期间筛选数据
   - 金额格式化显示（人民币格式）

3. **文件处理**
   - 多格式文件支持
   - 文件大小验证
   - Excel模板下载

4. **界面设计**
   - 与现有税费上传页面保持一致的设计风格
   - 使用 Tailwind CSS 进行样式设计
   - 图标使用 Lucide React

## 部署说明

1. 前端代码已完成开发和配置
2. 需要后端提供对应的API接口支持
3. 确保后端接口路径与前端服务调用一致
4. 建议在测试环境验证文件上传和数据展示功能

## 相关文件

- `src/services/personalTaxService.ts` - 个税上传服务接口
- `src/components/PersonalTaxUploadView.tsx` - 个税上传页面组件
- `src/App.tsx` - 路由配置
- `src/components/Sidebar.tsx` - 导航菜单配置

## 测试建议

1. 验证页面路由访问正常
2. 测试文件上传功能（各种格式）
3. 验证Excel模板下载
4. 测试分页和筛选功能
5. 验证响应式设计在不同设备上的表现